<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE knimeNode PUBLIC "-//UNIKN//DTD KNIME Node 2.0//EN" "http://www.knime.org/Node.dtd">
<knimeNode icon="./pdb_xml.png" type="Source">
    <name>PDB Connector (XML Query String)</name>
    
    <shortDescription>
        Source node to connect to RCSB PDB RESTful Web Services for advanced search and custom reporting.
    </shortDescription>
    
    <fullDescription>
        <intro><p>The <i>PDB Connector (XML Query String)</i> node provides connections to two RESTful Web Services for search and retrieval of information from the Protein Data Bank:
            <ul>
                <li>Advanced Search (http://www.rcsb.org/pdb/rest/search)</li>
                <li>Custom Report (http://www.rcsb.org/pdb/rest/customReport)</li>
            </ul>
        </p>
            <p>The user interface dialog options are designed to be a close mimic of the interactive reporting options provided at
                <a href="http://www.pdb.org/pdb/search/advSearch.do">http://www.pdb.org/pdb/search/advSearch.do</a> and the user
                is encouraged to explore this resource for a full explanation of each search option.  The query is entered as a single XML string
                in this node (For a user-friendly query builder version, see the original <i>PDB Connector</i> node).  This query can be copied
                and pasted from the "Query Details" link on a PDB query results page at the <a href="http://www.rcsb.org">RCSB PDB</a>.  
                The XML Query is made available as a flow variable (<i>xmlQuery</i>) after node execution.  Worked examples of using the node 
                using these methods are provided <a href="http://tech.knime.org/book/examples-of-using-the-pdb-connector-xml-query-node">here</a>.</p>
            <p>The node also allows for simple generation of a second report format table from a query run in either this or the <i>PDB Connector</i> node, as
            both nodes provide the query xml as a flow variable at the output ports.</p>
            <p>The node provides options to use either POST or GET report webservice variants.  The POST option is newer, and should be used unless machine memory is an issue 
            	(The node will download the entire report to memory).  The GET service requires multiple requests of the webservice, and URL length limits the number of hits which 
            	can be processed in each call, and the number of available report fields.  Lower values for the maximum URL length (2000-8000) will result in more calls, and fewer 
            	fields being available, but is more reliable when running through a proxy server.  Higher values should be used where possible.  Multiple calls to the GET service
            	are likely to be intercepted by the PDB server "Robot Blocker", adding further time to the query.  The GET service should be avoided wherever possible.  
            	The node will make a number of retries at increasing delay intervals (0, 1, 5, 10, 30, 60, 300, 600 seconds) to download each block of report 
            	data during the second part of the execution (There is an additional delay, defaulting to 1 second, on each attempt, which can be adjusted by 
            	adding the line -Dknime.url.timeout= followed by a value in milliseconds - e.g. 5000 for 5 seconds to the knime.ini file).</p>
            <p>The <i>PDB Connector (XML Query String)</i> node was developed by <a href="http://www.vernalis.com/">Vernalis (Cambridge, UK)</a>, based on the original 
            	<i>PDB Connector</i> node developed by <a href="http://www.enspiral-discovery.com/">Enspiral Discovery</a> in collaboration with
                <a href="http://www.vernalis.com/">Vernalis (Cambridge, UK)</a>.
                For feedback and more information, please contact <a href="mailto:knime@vernalis.com">knime@vernalis.com</a>
                </p>
        </intro>
        
        <tab name="Query Options">
        	<option name="Ligand Image Size">Select the ligand image size to use in the generation of ligand image URLs 
        		(applies to Ligand Image field only).</option>
        	<option name="Use POST Query method (Faster)">Select the POST or GET service.  GET is older, but may limit number of report fields which can 
        		be returned, and is slower.  If using the GET option, the maximum URL length can be set</option>
        	<option name="Max. Report GET URL Length">If using the GET option, the maximum URL length can be set between 2000 and 8000.  Higher values 
        		allow more fields to be returned, and result in fewer calls to the webservice, but may fall foul of proxy servers.</option>
        	<option name="Clear Query">Clear all query options.  If a flow variable has been set for the XML Query, this will also be un-set</option>
            <option name="Test Query">Test the current query, with display of result count.  If a flow variable has been 
            	specified for the xml query, it's value will be used in the test. (NB This behaviour is different from that in the PDB Connector node, 
            	where the 'Test' button uses the query configured in the dialog, without reference to flow variable settings.)</option>
            <option name="Messages">Messages relating to the Test Query button are displayed in this area</option>
            <option name="XML Query">The PDB XML advanced query text should be entered here.  See above for details</option>
        </tab>
        
        <tab name="Report Options">
            <option name="Select report">Use the dropdown menu to select from a number of predefined standard reports.  Select 
            	'Customizable Table' to allow fine-grained selection of all custom report fields, using the individual and group field selectors.</option>
            <option name="Select All">Initialise a Customizable Table with all report fields.</option>
            <option name="Clear All">Initialise a Customizable Table with no report fields.</option>
        </tab>
     
    </fullDescription>
    
    <ports>
    	<inPort index="0" name="Flow Variables (Optional)">Optional flow variable connection, which could contain the XML query in a flow variable</inPort>
        <outPort index="0" name="PDB IDs">One-column table of PDB IDs that match query</outPort>
        <outPort index="1" name="Custom report table">Custom report fields.</outPort>
    </ports>    
</knimeNode>
