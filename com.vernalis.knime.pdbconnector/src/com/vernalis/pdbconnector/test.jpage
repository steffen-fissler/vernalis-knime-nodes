String xml = "<describeHet><ligandInfo><ligand chemicalID=\"NAG\" type=\"D-saccharide\" molecularWeight=\"221.208\"><chemicalName>N-ACETYL-D-GLUCOSAMINE</chemicalName><formula>C8 H15 N O6</formula><InChIKey>OVRNDRQMDRJTHS-FMDGEEDCSA-N</InChIKey><InChI>InChI=1S/C8H15NO6/c1-3(11)9-5-7(13)6(12)4(2-10)15-8(5)14/h4-8,10,12-14H,2H2,1H3,(H,9,11)/t4-,5-,6-,7-,8-/m1/s1</InChI><smiles>CC(=O)N[C@@H]1[C@H]([C@@H]([C@H](O[C@H]1O)CO)O)O</smiles></ligand><ligand chemicalID=\"EBW\" type=\"non-polymer\" molecularWeight=\"406.603\"><chemicalName>4-(5-{4-[DIMETHYL(PROP-2-ENYL)AMMONIO]PHENYL}-3-OXOPENTYL)-N,N-DIMETHYL-N-PROP-2-ENYLBENZENAMINIUM</chemicalName><formula>C27 H38 N2 O 2</formula><InChIKey>ZAEXMNKDGJNLTA-UHFFFAOYSA-N</InChIKey><InChI>InChI=1S/C27H38N2O/c1-7-21-28(3,4)25-15-9-23(10-16-25)13-19-27(30)20-14-24-11-17-26(18-12-24)29(5,6)22-8-2/h7-12,15-18H,1-2,13-14,19-22H2,3-6H3/q+2</InChI><smiles>C[N+](C)(CC=C)c1ccc(cc1)CCC(=O)CCc2ccc(cc2)[N+](C)(C)CC=C</smiles></ligand><ligand chemicalID=\"SEP\" type=\"L-peptide linking\" molecularWeight=\"185.072\"><chemicalName>PHOSPHOSERINE</chemicalName><formula>C3 H8 N O6 P</formula><InChIKey>BZQFBWGGLXLEPQ-REOHCLBHSA-N</InChIKey><InChI>InChI=1S/C3H8NO6P/c4-2(3(5)6)1-10-11(7,8)9/h2H,1,4H2,(H,5,6)(H2,7,8,9)/t2-/m0/s1</InChI><smiles>C([C@@H](C(=O)O)N)OP(=O)(O)O</smiles></ligand></ligandInfo></describeHet>";
xml = xml.replaceAll("\\>[\\s]?\\<",">\n<");String[] xmlLines = xml.split("\n");
int tabLevel=0;String tabs="";String lastTag="";for (int i = 0, l = xmlLines.length; i<l; i++){	if(xmlLines[i].startsWith("</")){		tabs =tabs.substring (1);	} else if (xmlLines[i].startsWith("<")) {		tabs += "\t";	}	String currentTag= xmlLines[i].replaceAll("^\\<[/]?(.*?)[\\s\\>].*", "$1");	//System.out.println(currentTag);	xmlLines[i] = (tabs.substring(1) + xmlLines[i] + "\n"); //.replace("\t</","</");	if (currentTag.equals(lastTag)){		tabs=tabs.substring(1);	}	if (xmlLines[i].indexOf("</")>=0 || xmlLines[i].indexOf("/>")>=0){		tabs =tabs.substring (1);	}	lastTag=currentTag;		System.out.print(xmlLines[i]);}An exception occurred during evaluation:  java.lang.StringIndexOutOfBoundsExceptionString xml = "<describeHet>   <ligandInfo> <ligand chemicalID=\"NAG\" type=\"D-saccharide\" molecularWeight=\"221.208\"><chemicalName>N-ACETYL-D-GLUCOSAMINE</chemicalName><formula>C8 H15 N O6</formula><InChIKey>OVRNDRQMDRJTHS-FMDGEEDCSA-N</InChIKey><InChI>InChI=1S/C8H15NO6/c1-3(11)9-5-7(13)6(12)4(2-10)15-8(5)14/h4-8,10,12-14H,2H2,1H3,(H,9,11)/t4-,5-,6-,7-,8-/m1/s1</InChI><smiles>CC(=O)N[C@@H]1[C@H]([C@@H]([C@H](O[C@H]1O)CO)O)O</smiles></ligand><ligand chemicalID=\"EBW\" type=\"non-polymer\" molecularWeight=\"406.603\"><chemicalName>4-(5-{4-[DIMETHYL(PROP-2-ENYL)AMMONIO]PHENYL}-3-OXOPENTYL)-N,N-DIMETHYL-N-PROP-2-ENYLBENZENAMINIUM</chemicalName><formula>C27 H38 N2 O 2</formula><InChIKey>ZAEXMNKDGJNLTA-UHFFFAOYSA-N</InChIKey><InChI>InChI=1S/C27H38N2O/c1-7-21-28(3,4)25-15-9-23(10-16-25)13-19-27(30)20-14-24-11-17-26(18-12-24)29(5,6)22-8-2/h7-12,15-18H,1-2,13-14,19-22H2,3-6H3/q+2</InChI><smiles>C[N+](C)(CC=C)c1ccc(cc1)CCC(=O)CCc2ccc(cc2)[N+](C)(C)CC=C</smiles></ligand><ligand chemicalID=\"SEP\" type=\"L-peptide linking\" molecularWeight=\"185.072\"><chemicalName>PHOSPHOSERINE</chemicalName><formula>C3 H8 N O6 P</formula><InChIKey>BZQFBWGGLXLEPQ-REOHCLBHSA-N</InChIKey><InChI>InChI=1S/C3H8NO6P/c4-2(3(5)6)1-10-11(7,8)9/h2H,1,4H2,(H,5,6)(H2,7,8,9)/t2-/m0/s1</InChI><smiles>C([C@@H](C(=O)O)N)OP(=O)(O)O</smiles></ligand></ligandInfo></describeHet>";String indent="";String[] out=xml.replaceAll(">\\s*<",">\n<").split("\n");for(int i=0; i<out.length; i++){	//System.out.println(out[i]);	if(i>0&&out[i].startsWith("<")&&!out[i].startsWith("</")){		indent+="\t";	//System.out.println("*"+indent+"*");	}	out[i]=indent+out[i];	System.out.println(out[i]);	if(out[i].endsWith("/>")||out[i].matches("[\\t]*<(.*?)>.*</\\1>")||out[i].trim().startsWith("</")){		if(indent.length()>1){			indent=indent.substring(1);		} else {			indent="";		}	//	System.out.println("*"+indent+"*");	}	}String xml="<orgPdbCompositeQuery version=\"1.0\"><queryRefinement><queryRefinementLevel>0</queryRefinementLevel><orgPdbQuery><queryType>org.pdb.query.simple.AdvancedKeywordQuery</queryType><keywords>Hsp90</keywords></orgPdbQuery></queryRefinement><queryRefinement><queryRefinementLevel>1</queryRefinementLevel><conjunctionType>and</conjunctionType><orgPdbQuery><queryType>org.pdb.query.simple.AdvancedAuthorQuery</queryType><searchType>0</searchType><audit_author.name>Roughley,SD</audit_author.name><exactMatch>false</exactMatch></orgPdbQuery></queryRefinement></orgPdbCompositeQuery>";xml=XMLFormatter.indentXML(xml);System.out.println(xml);System.out.println("\n===\n");System.out.println(XMLQueryRenderer.XMLtoQuery2(xml));String test="<blah><blah><blah><blah>";System.out.println(XMLQueryRenderer.replaceNthOccurence(test,"<blah>","oops",3));