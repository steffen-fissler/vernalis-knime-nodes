<?xml version="1.0" encoding="UTF-8"?>
<knimeNode icon="./MMPLoopStart.png" type="LoopStart"
	xmlns="http://knime.org/node/v2.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://knime.org/node/v2.8 http://knime.org/node/v2.8.xsd">
	<name>MMP Fragmentation Type Loop Start</name>

	<shortDescription>
        This node allows simple looping through pre-defined fragmentation patterns
    </shortDescription>

	<fullDescription>
		<intro>
			<p>This node allows the user to select one or more of the pre-defined
				fragmentation types and loops through those selected. The
				current fragmentation type is exposed as a flow variable.
			</p>
			<p>
				A variety of fragmentation options are included:
				<ol>
					<li>"All acyclic single bonds" - Any acyclic single bond between
						any two atoms will be broken. This is the most exhaustive
						approach, but can generate a large number of pairs (rSMARTS:
						[*:1]!@!=!#[*:2]>>[*:1]-[*].[*:2]-[*])
					</li>
					<li>"Only acyclic single bonds to rings" - Single acyclic bonds
						between any atoms will be broken, as long as at least one atom is
						in a ring (rSMARTS: [*;R:1]!@!=!#[*:2]>>[*:1]-[*].[*:2]-[*]).
					</li>
					<li>"Only acyclic single bonds to either rings or to double bonds
						exocyclic to rings" - single acyclic bonds between any atoms will
						be broken, as long as 1 atom is either in a ring, or in a double
						bond exocyclic to a ring, with the other end in the ring (rSMARTS:
						[*:1]!@!=!#[*;!R0,$(*=!@[*!R0]):2]>>[*:1]-[*].[*:2]-[*])
					</li>
					<li>"Only single bonds to a heteroatom" - Single acyclic bonds
						between any two atoms, at least one of which is not Carbon will be
						broken. Included to mirror C-X bond breaking chemistry prevalent
						in modern drug discovery (e.g. SNAr, Reductive Aminations, Amide
						formations etc. See Ref. 2) (rSMARTS:
						[!#6:1]!@!=!#[*:2]>>[*:1]-[*].[*:2]-[*])
					</li>
					<li>"Non-functional group single bonds" - This
						reproduces the
						fragmentation pattern used in the original
						Hussein/Rea paper (See
						footnote 24, Ref. 1), and also used in the
						RDKit Python
						implementation (Ref 3) (rSMARTS:
						[#6+0;!$(*=,#[!#6]):1]!@!=!#[*:2]>>[*:1]-[*].[*:2]-[*])
					</li>
				</ol>
			</p>

			<p>
				This node was developed by
				<a href="http://www.vernalis-research.com/">Vernalis Research</a>
				.
				For feedback and more information, please contact
				<a href="mailto:knime@vernalis.com">
					knime@vernalis.com
				</a>
			</p>

			<p>
				1. J. Hussain and C Rea, "
				<i>Computationally efficient algorithm to identify matched molecular pairs (MMPs) in large datasets</i>
				",
				<i>J. Chem. Inf. Model.</i>
				, 2010,
				<b>50</b>
				, 339-348 (DOI:
				<a href="http://dx.doi.org/10.1021/ci900450m">10.1021/ci900450m</a>
				).
			</p>
			<p>
				2. S. D. Roughley and A. M. Jordan "
				<i>The Medicinal Chemistâ€™s Toolbox: An Analysis of Reactions Used in the Pursuit of Drug Candidates</i>
				",
				<i>J. Med. Chem.</i>
				, 2011,
				<b>54</b>
				, 3451-3479 (DOI:
				<a href="http://dx.doi.org/10.1021/jm200187y">10.1021/jm200187y</a>
				)
			</p>
			<p>
				3. G. Landrum "
				<a href="http://www.rdkit.org/docs/Overview.html#the-contrib-directory">An Overview of RDKit</a>
				"
				(http://www.rdkit.org/docs/Overview.html#the-contrib-directory)
				(section entitled 'mmpa')
			</p>
		</intro>


		<option name="Bond match types">Select the desired fragmentation types
		</option>

	</fullDescription>

	<ports>
		<inPort index="0" name="Molecules">Molecules for fragmenting
		</inPort>
		<outPort index="0" name="Molecules-with-types">The unchanged input table, with a
			fragmentation type exposed in the flow variables as 'Fragmentation
			Type'
		</outPort>

	</ports>

</knimeNode>
